### 项目介绍
我们组的工作是用Rust语言改写LiteOS-M的动态内存模块，即los_memory.c文件。

### 立项依据
##### 为什么选择LiteOS-M
- 工作量适合
OpenHarmony LiteOS-M是华为开发的一个开源轻量级实时操作系统，面向物联网 (IoT) 领域。它的主要特点是体积小、资源占用少，适用于微控制器单元 (MCU) 和其他资源受限的嵌入式设备。其开源项目代码量对初步接触操作系统的人来说适中，适合作为改写项目的对象。
- 功能齐全
目前 LiteOS 开源项目支持 ARM64、ARM Cortex-A、ARM Cortex-M0，Cortex-M3，Cortex-M4，Cortex-M7 等多种芯片架构。其内核架构包括不可裁剪的极小内核和可裁剪的其他模块。极小内核包含任务管理、内存管理、中断管理、异常管理和系统时钟。可裁剪的模块包括信号量、互斥锁、队列管理、事件管理、软件定时器等。
- 生态丰富
LiteOS 还集成了一些网络协议栈，比如 CoAP 和 MQTT，这使得它能够更容易地用于构建物联网应用。此外，LiteOS 支持与 Huawei LiteOS IoT SDK 和 HiLink 平台的集成，这为开发者提供了丰富的开发资源和广泛的设备生态。
- 目前存在的局限性
LiteOS 作为一个轻量级的实时操作系统（RTOS），在设计上主要针对资源受限的嵌入式设备。尽管它在这些领域表现出色，但仍存在一些局限性，尤其在安全性、性能、可维护性和生态兼容性方面，我们小组主要考虑改进的是安全性。
在安全性方面，LiteOS 也在持续进行改进，增加了一些安全特性来保护设备免受常见威胁。然而，由于其设计初衷是轻量化，并未专门为高安全需求的应用设计，因此它在安全机制上可能不如一些为安全性设计更为深入的操作系统，如细粒度的访问控制、安全启动、运行时防护等。并且由于其资源受限，LiteOS 可能没有足够的资源来实施复杂的安全机制，如硬件加速的加密和解密功能。
##### 为什么选择动态内存模块los_memory.c
- los_memory.c是LiteOS的动态内存管理模块,涉及底层且有较好的泛用性，建议用Rust的alloc模块替换。Rust的alloc模块提供了安全的动态内存分配和释放机制,可以在编译时防止常见的内存安全问题。Rust的alloc模块已经非常成熟,可以满足大多数动态内存管理的需求。使用Rust重写los_memory.c后,可以在编译时捕获大多数内存安全问题,提高系统的可靠性。
- los_memory.c的代码量:2300line+,部分相关文件:los_memory.h,相关文件代码量:500line+。
- memory模块的函数频繁的对指针进行传递操作,若使用不当可能会造成空指针解引用。且memory模块存在较严重的缓冲区溢出问题，因为LiteOS-M作为嵌入式操作系统，内存空间是连续分配的，且缺乏分页保护机制，这可能导致越界访问到相邻内存块的头节点,将其中关于内存块的前后节点、内存块长度等信息覆盖掉,引发严重危机。而Rust语言的安全性可以解决这些问题。
##### 为什么选择rust
###### Rust语言的优势
Rust语言主要在安全性、性能、生态支持、市场需求方面有如下优势：
- 安全性
    Rust 在安全性方面具有以下具体优势：
    1. 所有权和借用检查:
    Rust 通过所有权（ownership）和借用（borrowing）规则强制执行内存安全，防止悬垂指针和数据竞争等问题。
    2. 类型系统:
    Rust 的类型系统十分强大，它可以在编译时期捕获许多错误，包括无效的索引、类型不匹配和无效的引用等。
    3. 无垃圾回收:
    Rust 不使用垃圾回收机制，因此避免了垃圾回收可能引起的延迟和复杂性，同时也减少了内存泄漏的风险。
    4. 并发原语:
    Rust 提供了安全的并发原语，如互斥锁（Mutexes）、读写锁（RwLocks）、原子操作等，帮助开发者编写并发代码而不用担心数据竞争。
    5. 生命周期:
    Rust 的生命周期（lifetimes）概念确保了引用的有效性，防止了悬垂引用的产生。
    6. 抽象安全:
    Rust 允许开发者编写抽象代码而不必牺牲安全性，因为它的类型系统和所有权模型可以在编译时确保抽象的正确实现。
    7. 错误处理:
    Rust 提供了一种表达性强的错误处理机制，要求显式地处理潜在的错误，避免了隐藏的错误和意外行为。
    8. 标准库:
    Rust 的标准库经过精心设计，提供了一系列安全的数据结构和算法，减少了开发者自行实现时可能引入的安全漏洞。
    9. 社区和生态:
    Rust 社区注重安全，经常进行代码审计，并在生态系统中提供了大量的安全工具和库。
    10. 编译时检查:
    Rust 的编译器能够在代码编译时执行严格的检查，以确保遵守了语言的安全规则。这些特性共同使得 Rust 成为一个在系统编程和嵌入式开发领域中备受推崇的安全语言选择。
- 高性能
    Rust 语言在改写 LiteOS 时，在性能方面的具体优势体现在以下几个方面：
    1. 零开销抽象:
    Rust 的抽象不会引入运行时开销。它允许开发者直接操作硬件，同时提供了高级抽象，这意味着可以在保持性能的同时，编写出更安全、更易于维护的代码。
    2. 优化的编译器:
    Rust 的编译器（例如 LLVM）经过优化，能够生成高效的机器码。编译器会进行各种优化，比如内联函数、循环展开、向量化等，以提升执行效率。
    3. 数据并行和并行计算:
    Rust 支持数据并行和并行计算，这可以充分利用多核处理器的能力，加快计算密集型任务的执行速度。
    4. 无垃圾收集器:
    Rust 没有垃圾收集器（GC），这避免了 GC 可能带来的暂停和不确定的延迟。在实时操作系统中，这种确定性是非常重要的。
    5. 控制流分析:
    Rust 的编译器能够进行复杂的控制流分析，优化代码路径，减少不必要的检查和跳转，从而提高执行速度。
    6. 缓存友好的数据布局:
    Rust 允许开发者精确控制数据的内存布局，这有助于优化数据在缓存中的访问模式，减少缓存未命中。
    7. 硬件接近性:
    Rust 提供了与硬件接近的编程接口，允许开发者编写高效的硬件操作代码，而不必通过高级抽象层。
    8. 异步编程:
    Rust 的异步编程模型（通过 ‘async‘/‘await‘关键字）允许非阻塞 IO 操作，这可以在不 牺牲多任务处理能力的情况下，提高 IO 密集型应用的性能。
- Rust语言的社会与生态支持
    Rust 语言项目开发有着丰富的社会与生态支持，具体表现如下：
    1. Rust 语言本身的生态:
    Rust 语言拥有一个活跃的社区和丰富的生态系统，提供了大量的库（crates），这些库可以用来处理网络、加密、串口通信、硬件抽象等在嵌入式系统中常见的功能。
    2. 工具链:
    Rust 提供了稳定的工具链，包括编译器、包管理器（Cargo）和各种调试工具，这些工具支持跨平台编译和部署，非常适合嵌入式开发
    3. cortex-m 系列 crate:
    对于基于 ARM Cortex-M 微控制器的系统，存在一系列专门的 crate，比如 cortex-m、cortex-m-rt 和 cortex-m-semihosting，它们提供了对 Cortex-M 核心的支持，包括上下文切换、中断处理等功能。对应的 github 仓库网站：https://github.com/rust-embedded/cortex-m
    4. 官方资源:
    Rust 语言的官方网站提供了大量的教程、文档和指南，帮助开发者学习如何使用 Rust进行嵌入式开发。对应官方网站：https://www.rust-lang.org/
    5. 论坛和社区:
    Rust 社区活跃在多个论坛和社交媒体平台，如 Reddit、Stack Overflow、Discord 和 IRC，开发者可以在这些平台上提问、分享经验和获取帮助。
    6. 教育资源:
    存在很多在线课程、书籍和教程专注于 Rust 的嵌入式开发，例如“The Embedded RustBook”和“Bare Metal Programming in Rust”。
- 市场需求
    在LiteOS-M的安全性方面，当前市场可能存在以下需求：
    1. 增强的内存保护:
    市场需要能够防止恶意软件和程序错误导致的内存破坏的机制。
    2. 更精细的访问控制:
    为了保护敏感数据和功能，需要实现基于角色的访问控制（RBAC）或类似机制。
    3. 执行保护机制:
    需要实施代码和数据执行保护措施来防止恶意代码执行。
    4. 漏洞管理和响应:
    市场需要有效的漏洞发现、评估、通知和修复流程。
    5. 加密和认证支持:
    需要集成更强大的加密库，支持数据加密、安全认证和数字签名等功能。
    6. 网络安全增强:
    市场需求包括防火墙、入侵检测系统和支持 SSL/TLS 的网络安全解决方案。
    7. 安全启动:
    为了保证系统在启动过程中不被篡改，需要实现安全启动机制。
    8. 限制调试和日志记录:
    需要对调试信息和日志记录进行限制，以减少潜在的安全风险。
    9. 第三方组件的安全管理:
    市场需要确保所有依赖的第三方库和组件都是最新和最安全的版本。
    10. 用户教育和文档:
    对于特定行业或应用，可能需要定制化的安全解决方案来满足特殊的安全需求。
    11. 合规性和标准遵从性:
    市场需求包括符合各种国际安全标准和法规，如 ISO/IEC 27001、GDPR 等。
    随着物联网设备在各个行业的广泛应用，对 LiteOS 等轻量级操作系统的安全性要求越来越高，因此上述市场需求对于提升 LiteOS 的竞争力和市场份额至关重要。




